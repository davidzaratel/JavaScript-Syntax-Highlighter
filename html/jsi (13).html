<!DOCTYPE html>
    <html>
    <head>
      <title> Javascript Script Highlighter</title>
      <link rel='stylesheet' href='../css/styles.css'>
    </head>
    <body>
    <h1>Javascript script highlighter</h1>
    <h3> By: David Zarate Lopez A01329795</h3>
    <br>
    <pre><code><span class="reserved">const</span><span> </span><span class="identifier">getAllBetween</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">require</span><span class="signs">(</span><span class="string">'./utils/between-headings'</span><span class="signs">)</span><span class="signs">;</span><br><span class="comment">// const visit = require('unist-util-visit');
</span><span class="reserved">const</span><span> </span><span class="identifier">visitChildren</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">require</span><span class="signs">(</span><span class="string">'unist-util-visit-children'</span><span class="signs">)</span><span class="signs">;</span><br><span class="reserved">const</span><span> </span><span class="signs">{</span><span> </span><span class="identifier">root</span><span> </span><span class="signs">}</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">require</span><span class="signs">(</span><span class="string">'mdast-builder'</span><span class="signs">)</span><span class="signs">;</span><br><span class="reserved">const</span><span> </span><span class="signs">{</span><span> </span><span class="identifier">getFileVisitor</span><span> </span><span class="signs">}</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">require</span><span class="signs">(</span><span class="string">'./utils/get-file-visitor'</span><span class="signs">)</span><span class="signs">;</span><br><span class="reserved">const</span><span> </span><span class="signs">{</span><span> </span><span class="identifier">isEmpty</span><span> </span><span class="signs">}</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">require</span><span class="signs">(</span><span class="string">'lodash'</span><span class="signs">)</span><span class="signs">;</span><br><br><span class="reserved">const</span><span> </span><span class="identifier">editableRegionMarker</span><span> </span><span class="signs">=</span><span> </span><span class="string">'--fcc-editable-region--'</span><span class="signs">;</span><br><br><span class="reserved">function</span><span> </span><span class="identifier">findRegionMarkers</span><span class="signs">(</span><span class="identifier">file</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">lines</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">file</span><span class="signs">.</span><span class="identifier">contents</span><span class="signs">.</span><span class="identifier">split</span><span class="signs">(</span><span class="string">'\n'</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">editableLines</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">lines</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">.</span><span class="identifier">map</span><span class="signs">(</span><span class="signs">(</span><span class="identifier">line</span><span class="signs">,</span><span> </span><span class="identifier">id</span><span class="signs">)</span><span> </span><span class="signs">=</span><span class="signs">></span><span> </span><span class="signs">(</span><span class="identifier">line</span><span class="signs">.</span><span class="identifier">trim</span><span class="signs">(</span><span class="signs">)</span><span> </span><span class="signs">=</span><span class="signs">=</span><span class="signs">=</span><span> </span><span class="identifier">editableRegionMarker</span><span> </span><span class="signs">?</span><span> </span><span class="identifier">id</span><span> </span><span class="signs">:</span><span> </span><span class="signs">-</span><span class="num">1</span><span class="signs">)</span><span class="signs">)</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">.</span><span class="identifier">filter</span><span class="signs">(</span><span class="identifier">id</span><span> </span><span class="signs">=</span><span class="signs">></span><span> </span><span class="identifier">id</span><span> </span><span class="signs">></span><span class="signs">=</span><span> </span><span class="num">0</span><span class="signs">)</span><span class="signs">;</span><br><br><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">editableLines</span><span class="signs">.</span><span class="identifier">length</span><span> </span><span class="signs">></span><span> </span><span class="num">2</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><span class="string">'Editable region has too many markers: '</span><span> </span><span class="signs">+</span><span> </span><span class="identifier">editableLines</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="signs">}</span><br><br><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">editableLines</span><span class="signs">.</span><span class="identifier">length</span><span> </span><span class="signs">=</span><span class="signs">=</span><span class="signs">=</span><span> </span><span class="num">0</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">return</span><span> </span><span class="bool">null</span><span class="signs">;</span><br><span> </span><span> </span><span class="signs">}</span><span> </span><span class="reserved">else</span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">editableLines</span><span class="signs">.</span><span class="identifier">length</span><span> </span><span class="signs">=</span><span class="signs">=</span><span class="signs">=</span><span> </span><span class="num">1</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><span class="string">`Editable region not closed`</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="signs">}</span><span> </span><span class="reserved">else</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">return</span><span> </span><span class="identifier">editableLines</span><span class="signs">;</span><br><span> </span><span> </span><span class="signs">}</span><br><span class="signs">}</span><br><br><span class="reserved">function</span><span> </span><span class="identifier">removeLines</span><span class="signs">(</span><span class="identifier">contents</span><span class="signs">,</span><span> </span><span class="identifier">toRemove</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">lines</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">contents</span><span class="signs">.</span><span class="identifier">split</span><span class="signs">(</span><span class="string">'\n'</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="reserved">return</span><span> </span><span class="identifier">lines</span><span class="signs">.</span><span class="identifier">filter</span><span class="signs">(</span><span class="signs">(</span><span class="identifier">_</span><span class="signs">,</span><span> </span><span class="identifier">id</span><span class="signs">)</span><span> </span><span class="signs">=</span><span class="signs">></span><span> </span><span class="signs">!</span><span class="identifier">toRemove</span><span class="signs">.</span><span class="identifier">includes</span><span class="signs">(</span><span class="identifier">id</span><span class="signs">)</span><span class="signs">)</span><span class="signs">.</span><span class="identifier">join</span><span class="signs">(</span><span class="string">'\n'</span><span class="signs">)</span><span class="signs">;</span><br><span class="signs">}</span><br><br><span class="comment">// TODO: DRY this.  Start with an array of markers and go from there.
</span><span class="reserved">function</span><span> </span><span class="identifier">addSeeds</span><span class="signs">(</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span class="reserved">function</span><span> </span><span class="identifier">transformer</span><span class="signs">(</span><span class="identifier">tree</span><span class="signs">,</span><span> </span><span class="identifier">file</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">seedTree</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">root</span><span class="signs">(</span><span class="identifier">getAllBetween</span><span class="signs">(</span><span class="identifier">tree</span><span class="signs">,</span><span> </span><span class="string">`--seed--`</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="comment">// Not all challenges have seeds (video challenges, for example), so we stop
</span><span> </span><span> </span><span> </span><span> </span><span class="comment">// processing in these cases.
</span><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">isEmpty</span><span class="signs">(</span><span class="identifier">seedTree</span><span class="signs">.</span><span class="identifier">children</span><span class="signs">)</span><span class="signs">)</span><span> </span><span class="reserved">return</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">contentsTree</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">root</span><span class="signs">(</span><span class="identifier">getAllBetween</span><span class="signs">(</span><span class="identifier">seedTree</span><span class="signs">,</span><span> </span><span class="string">`--seed-contents--`</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">headTree</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">root</span><span class="signs">(</span><span class="identifier">getAllBetween</span><span class="signs">(</span><span class="identifier">seedTree</span><span class="signs">,</span><span> </span><span class="string">`--before-user-code--`</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">tailTree</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">root</span><span class="signs">(</span><span class="identifier">getAllBetween</span><span class="signs">(</span><span class="identifier">seedTree</span><span class="signs">,</span><span> </span><span class="string">`--after-user-code--`</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">seeds</span><span> </span><span class="signs">=</span><span> </span><span class="signs">{</span><span class="signs">}</span><span class="signs">;</span><br><br><span> </span><span> </span><span> </span><span> </span><span class="comment">// While before and after code are optional, the contents are not
</span><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">isEmpty</span><span class="signs">(</span><span class="identifier">contentsTree</span><span class="signs">.</span><span class="identifier">children</span><span class="signs">)</span><span class="signs">)</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><span class="string">'## --seed-contents-- must appear in # --seed-- sections'</span><span class="signs">)</span><span class="signs">;</span><br><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">visitForContents</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">visitChildren</span><span class="signs">(</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="identifier">getFileVisitor</span><span class="signs">(</span><span class="identifier">seeds</span><span class="signs">,</span><span> </span><span class="string">'contents'</span><span class="signs">,</span><span> </span><span class="identifier">validateEditableMarkers</span><span class="signs">)</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">visitForHead</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">visitChildren</span><span class="signs">(</span><span class="identifier">getFileVisitor</span><span class="signs">(</span><span class="identifier">seeds</span><span class="signs">,</span><span> </span><span class="string">'head'</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">visitForTail</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">visitChildren</span><span class="signs">(</span><span class="identifier">getFileVisitor</span><span class="signs">(</span><span class="identifier">seeds</span><span class="signs">,</span><span> </span><span class="string">'tail'</span><span class="signs">)</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="identifier">visitForContents</span><span class="signs">(</span><span class="identifier">contentsTree</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="identifier">visitForHead</span><span class="signs">(</span><span class="identifier">headTree</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="identifier">visitForTail</span><span class="signs">(</span><span class="identifier">tailTree</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="identifier">file</span><span class="signs">.</span><span class="identifier">data</span><span> </span><span class="signs">=</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">.</span><span class="signs">.</span><span class="signs">.</span><span class="identifier">file</span><span class="signs">.</span><span class="identifier">data</span><span class="signs">,</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="identifier">files</span><span class="signs">:</span><span> </span><span class="identifier">seeds</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><span class="signs">;</span><br><br><span> </span><span> </span><span> </span><span> </span><span class="comment">// process region markers - remove them from content and add them to data
</span><span> </span><span> </span><span> </span><span> </span><span class="identifier">Object</span><span class="signs">.</span><span class="identifier">keys</span><span class="signs">(</span><span class="identifier">seeds</span><span class="signs">)</span><span class="signs">.</span><span class="identifier">forEach</span><span class="signs">(</span><span class="identifier">key</span><span> </span><span class="signs">=</span><span class="signs">></span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">fileData</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">seeds</span><span class="signs">[</span><span class="identifier">key</span><span class="signs">]</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">editRegionMarkers</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">findRegionMarkers</span><span class="signs">(</span><span class="identifier">fileData</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">editRegionMarkers</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="identifier">fileData</span><span class="signs">.</span><span class="identifier">contents</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">removeLines</span><span class="signs">(</span><span class="identifier">fileData</span><span class="signs">.</span><span class="identifier">contents</span><span class="signs">,</span><span> </span><span class="identifier">editRegionMarkers</span><span class="signs">)</span><span class="signs">;</span><br><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">editRegionMarkers</span><span class="signs">[</span><span class="num">1</span><span class="signs">]</span><span> </span><span class="signs"><</span><span class="signs">=</span><span> </span><span class="identifier">editRegionMarkers</span><span class="signs">[</span><span class="num">0</span><span class="signs">]</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><span class="string">'Editable region must be non zero'</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="identifier">fileData</span><span class="signs">.</span><span class="identifier">editableRegionBoundaries</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">editRegionMarkers</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><span> </span><span class="reserved">else</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="identifier">fileData</span><span class="signs">.</span><span class="identifier">editableRegionBoundaries</span><span> </span><span class="signs">=</span><span> </span><span class="signs">[</span><span class="signs">]</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="signs">}</span><br><br><span> </span><span> </span><span class="reserved">return</span><span> </span><span class="identifier">transformer</span><span class="signs">;</span><br><span class="signs">}</span><br><br><span class="reserved">function</span><span> </span><span class="identifier">validateEditableMarkers</span><span class="signs">(</span><span class="signs">{</span><span> </span><span class="identifier">value</span><span class="signs">,</span><span> </span><span class="identifier">position</span><span> </span><span class="signs">}</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">twoMarkersRE</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">RegExp</span><span class="signs">(</span><br><span> </span><span> </span><span> </span><span> </span><span class="identifier">editableRegionMarker</span><span> </span><span class="signs">+</span><span> </span><span class="string">'.*'</span><span> </span><span class="signs">+</span><span> </span><span class="identifier">editableRegionMarker</span><br><span> </span><span> </span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">formattedMarkerRE</span><span> </span><span class="signs">=</span><span> </span><span class="signs">/</span><span class="signs">-</span><span class="signs">-</span><span class="identifier">fcc</span><span> </span><span class="signs">-</span><span> </span><span class="identifier">editable</span><span> </span><span class="signs">-</span><span> </span><span class="identifier">region</span><span class="signs">-</span><span class="signs">-</span><span class="signs">/</span><span class="signs">;</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">lines</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">value</span><span class="signs">.</span><span class="identifier">split</span><span class="signs">(</span><span class="string">'\n'</span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span class="reserved">const</span><span> </span><span class="identifier">baseLineNumber</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">position</span><span class="signs">.</span><span class="identifier">start</span><span class="signs">.</span><span class="identifier">line</span><span> </span><span class="signs">+</span><span> </span><span class="num">1</span><span class="signs">;</span><br><span> </span><span> </span><span class="identifier">lines</span><span class="signs">.</span><span class="identifier">forEach</span><span class="signs">(</span><span class="signs">(</span><span class="identifier">line</span><span class="signs">,</span><span> </span><span class="identifier">index</span><span class="signs">)</span><span> </span><span class="signs">=</span><span class="signs">></span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">line</span><span class="signs">.</span><span class="identifier">match</span><span class="signs">(</span><span class="identifier">twoMarkersRE</span><span class="signs">)</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="string">`Line ${
          baseLineNumber + index
        } has two markers. Each line should only have one.`</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><br><span> </span><span> </span><span> </span><span> </span><span class="reserved">if</span><span> </span><span class="signs">(</span><span class="identifier">line</span><span class="signs">.</span><span class="identifier">match</span><span class="signs">(</span><span class="identifier">formattedMarkerRE</span><span class="signs">)</span><span class="signs">)</span><span> </span><span class="signs">{</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="reserved">throw</span><span> </span><span class="identifier">Error</span><span class="signs">(</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="string">`Line ${
          baseLineNumber + index
        } has a malformed marker. It should be --fcc-editable-region--`</span><br><span> </span><span> </span><span> </span><span> </span><span> </span><span> </span><span class="signs">)</span><span class="signs">;</span><br><span> </span><span> </span><span> </span><span> </span><span class="signs">}</span><br><span> </span><span> </span><span class="signs">}</span><span class="signs">)</span><span class="signs">;</span><br><span class="signs">}</span><br><br><span class="identifier">module</span><span class="signs">.</span><span class="identifier">exports</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">addSeeds</span><span class="signs">;</span><br><span class="identifier">module</span><span class="signs">.</span><span class="identifier">exports</span><span class="signs">.</span><span class="identifier">editableRegionMarker</span><span> </span><span class="signs">=</span><span> </span><span class="identifier">editableRegionMarker</span><span class="signs">;</span><br></code></pre>
    </body>
    </html>